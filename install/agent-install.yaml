version: 3
name: resume-tailor-skill-deps

platform_profiles:
  opencode:
    skills_dir: ~/.config/opencode/skills
  claude-code:
    skills_dir: ./_deps/skills

requirements:
  # On Windows (non-WSL), replace python3 with py -3
  - check: python3 --version
  - check: git --version

sources:
  - id: anthropics-skills
    repo: https://github.com/anthropics/skills
    cache_dir: <skills_dir>/_upstream_anthropic_skills
    skills:
      - pdf
      - docx
  - id: blader-humanizer
    repo: https://github.com/blader/humanizer
    cache_dir: <skills_dir>/_upstream_humanizer
    skills:
      - humanizer

sync_policy:
  strategy: pull-or-clone
  pull_command: git -C <cache_dir> pull --ff-only
  clone_command: git clone <repo> <cache_dir>

install_plan:
  - run: python3 -m pip install -r requirements.txt
  - sync_repo:
      source_id: anthropics-skills
  - sync_repo:
      source_id: blader-humanizer
  - install_skill:
      source_id: anthropics-skills
      skill: pdf
      from: <skills_dir>/_upstream_anthropic_skills/skills/pdf
      to: <skills_dir>/pdf
      mode: copy
      overwrite: true
  - install_skill:
      source_id: anthropics-skills
      skill: docx
      from: <skills_dir>/_upstream_anthropic_skills/skills/docx
      to: <skills_dir>/docx
      mode: copy
      overwrite: true
  - install_skill:
      source_id: blader-humanizer
      skill: humanizer
      from: <skills_dir>/_upstream_humanizer
      to: <skills_dir>/humanizer
      mode: copy
      overwrite: true

post_check:
  - ensure_exists: <skills_dir>/pdf/SKILL.md
  - ensure_exists: <skills_dir>/docx/SKILL.md
  - ensure_exists: <skills_dir>/humanizer/SKILL.md
  - ensure_absent: <skills_dir>/humanizer-zh/SKILL.md

report:
  - print: installed skills => pdf, docx, humanizer
  - print: skipped skill => humanizer-zh
